EMCC = emcc
SOURCES = web/main.cpp web/webgl.c

EMFLAGS = -g -s WASM=1 --closure 1 -s TEXTDECODER=2 -s MINIMAL_RUNTIME=2 -s MIN_WEBGL_VERSION=2 -s MAX_WEBGL_VERSION=2 -s ABORTING_MALLOC=0 -s ENVIRONMENT=web -s GL_SUPPORT_AUTOMATIC_ENABLE_EXTENSIONS=0 -s GL_EXTENSIONS_IN_PREFIXED_FORMAT=0 -s GL_POOL_TEMP_BUFFERS=0 -s AGGRESSIVE_VARIABLE_ELIMINATION=1 --emit-symbol-map -s DISABLE_DEPRECATED_FIND_EVENT_TARGET_BEHAVIOR=1 -s FILESYSTEM=0 -s SUPPORT_ERRNO=0 -s GL_TRACK_ERRORS=0 -lGL -Oz

build:
	rm -rf out
	mkdir out
	$(EMCC) $(EMFLAGS) $(SOURCES) -I src -I include -o out/test.html

clean:
	rm remote.wasm
	rm remote.js